<!doctype html>
<html itemtype="http://schema.org/Blog" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta
      content="width=device-width, initial-scale=1, maximum-scale=1"
      name="viewport"
    />
    <meta
      content="Martin Klepsch (martinklepsch@googlemail.com)"
      itemprop="author"
      name="author"
    />
    <meta
      content="blog, clojure, development, clojurescript, heroku, amazon s3, aws"
      itemprop="keywords"
      name="keywords"
    />
    <meta
      content="Lately I've spent some time setting up a blog for a friend. Ghost is where it's at these days when it comes to blogging â€” unless you're a nerd like me who loves to mess around with static si..."
      itemprop="description"
      name="description"
    />
    <link
      href="https://martinklepsch.org/posts/localizing-a-ghost-theme.html"
      rel="canonical"
    />
    <title>Localizing a Ghost Theme â€” Martin Klepsch</title>
    <meta content="Localizing a Ghost Theme" property="og:title" />
    <meta content="article" property="og:type" />
    <meta
      content="Lately I've spent some time setting up a blog for a friend. Ghost is where it's at these days when it comes to blogging â€” unless you're a nerd like me who loves to mess around with static si..."
      property="og:description"
    />
    <meta
      content="https://martinklepsch.org/posts/localizing-a-ghost-theme.html"
      property="og:url"
    />
    <meta
      content="https://martinklepsch.org/images/selfies/2.jpg"
      property="og:image"
    />
    <meta content="martinklepsch.org" property="og:site_name" />
    <meta content="summary" name="twitter:card" />
    <meta content="@martinklepsch" name="twitter:site" />
    <meta content="@martinklepsch" name="twitter:creator" />
    <meta content="Localizing a Ghost Theme" name="twitter:title" />
    <meta
      content="Lately I've spent some time setting up a blog for a friend. Ghost is where it's at these days when it comes to blogging â€” unless you're a nerd like me who loves to mess around with static si..."
      name="twitter:description"
    />
    <meta
      content="https://martinklepsch.org/images/selfies/2.jpg"
      name="twitter:image"
    />
    <link href="/images/favicon.ico" rel="shortcut icon" />
    <link
      href="/atom.xml"
      rel="alternate"
      title="Sitewide Atom Feed"
      type="application/atom+xml"
    />
    <link
      href="https://unpkg.com/basscss@8.0.2/css/basscss.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/stylesheets/martinklepschorg-v3.css"
      rel="stylesheet"
      type="text/css"
    />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(["_setAccount", "UA-3138561-8"]);
      _gaq.push(["_setDomainName", "martinklepsch.org"]);
      _gaq.push(["_trackPageview"]);

      setTimeout("_gaq.push(['_trackEvent', '15_seconds', 'read'])", 15000);

      (function () {
        var ga = document.createElement("script");
        ga.type = "text/javascript";
        ga.async = true;
        ga.src =
          ("https:" == document.location.protocol
            ? "https://ssl"
            : "http://www") + ".google-analytics.com/ga.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="post">
    <div class="mx1">
      <div class="max-width-3 mx-auto mb5">
        <div
          class="p2 max-width-2 mx-auto border-left border-right border-bottom"
          style="
            box-shadow:
              0 1px 3px 0 rgb(0 0 0 / 0.1),
              0 1px 2px -1px rgb(0 0 0 / 0.1);
            border-radius: 0 0 4px 4px;
            border-color: rgb(0 0 0 / 0.3);
          "
        >
          Check out <a href="https://dynogee.com?ref=mk">Dynogee</a>, a new
          project I'm working on.
        </div>
        <article
          class="mt4"
          itemprop="blogPost"
          itemscope=""
          itemtype="http://schema.org/BlogPosting"
        >
          <div class="h4 db mx-auto max-width-2">
            <a
              href="/posts/localizing-a-ghost-theme.html"
              title="Permalink: Localizing a Ghost Theme"
              >May 2021</a
            ><span class="px1">/</span><a href="/" title="Home">Home</a
            ><span class="px1">/</span
            ><a
              href="https://twitter.com/martinklepsch"
              title="@martinklepsch on Twitter"
              >@martinklepsch</a
            >
          </div>
          <h1 class="h3 bold w-80-ns lh-title max-width-2 mx-auto my3">
            Localizing a Ghost Theme
          </h1>
          <section class="mkdwn lh-copy">
            <p>
              Lately I've spent some time setting up a blog for a friend.
              <a href="https://ghost.org/">Ghost</a> is where it's at these days
              when it comes to blogging â€” unless you're a nerd like me who loves
              to mess around with static site generators every now and then. ðŸ˜…
            </p>
            <p>
              Ghost provides many beautiful themes out of the box but most of
              them don't seem to support localization, which would be a nice
              thing to have for my friends blog. So I did some digging and
              essentially it comes down to:
            </p>
            <ol>
              <li>
                Using the <code>{{t}}</code> helper for any strings that should
                be localized (<a
                  href="https://ghost.org/docs/themes/helpers/translate/"
                  >docs</a
                >)
              </li>
              <li>
                Providing a <code>locales/de.json</code> file with mappings to
                localized strings
              </li>
            </ol>
            <p>
              The <a href="https://github.com/TryGhost/Dawn">Dawn theme</a> that
              we were using was pretty light on strings that needed localization
              so with a little bit of
              <a href="https://github.com/machakann/vim-sandwich"
                >vim-sandwich</a
              >
              magic and a custom mapping I was able to update it to use the
              <code>{{t}}</code> helper in maybe half an hour.
            </p>
            <pre><code>xmap &lt;Leader&gt;t sai{{t &quot;&lt;CR&gt;&quot;}}&lt;CR&gt;
</code></pre>
            <p>
              With the visual mapping above all I needed to do is select the
              text that I want to localize and hit <code>&lt;space&gt;t</code>.
            </p>
            <p>
              <img
                alt="selecting some text and using vim-sandwich to wrap it in {{t}}"
                src="/images/uploads/sandwich-magic.gif"
                title="vim sandwich wrapping with custom head/tail"
              />
            </p>
            <p>
              Now the last step was to create the initial
              <code>locales/en.json</code> file. Later on I will use the English
              one as a template to create a German localization.
            </p>
            <p>
              Since typing out the <em>more than a dozen</em> strings manually
              would have been boring I instead wrote a
              <a href="https://babashka.org/">babashka</a> script to generate
              the English locales file for me.
            </p>
            <pre><code class="clojure">#!/usr/bin/env bb
(require '[clojure.java.io :as io]
         '[cheshire.core :as json]
         '[babashka.fs :as fs])

(def entries
  (-&gt;&gt; (fs/glob &quot;.&quot; &quot;**/*.hbs&quot;)
       (map (fn [p] (slurp (io/file (str p)))))
       (mapcat (fn [file-contents]
                 (map second (re-seq #&quot;\{\{t \&quot;(.*)\&quot;\}\}&quot; file-contents))))
       (set)
       (map (fn [s] [s s]))
       (into {})))

(println (json/generate-string entries {:pretty true}))
</code></pre>
            <p>
              This script essentially finds all usages of the
              <code>{{t}}</code> helper and spits out a JSON object where the
              keys are identical to the values (i.e. if the theme was English,
              that would be the <code>locales/en.json</code> file).
            </p>
            <p>
              Babashka makes figuring this stuff out such a breeze because I can
              just incrementally build this out in a connected babashka nREPL
              session instead of changing the file and running the script as a
              whole on every change. REPLs for the win!
            </p>
            <p>
              In the end I created
              <a href="https://github.com/TryGhost/Dawn/pull/38"
                >this little PR to the theme</a
              >.
            </p>
          </section>
        </article>
        <div class="my3 em-before max-width-2 mx-auto">
          <a href="https://twitter.com/martinklepsch">@martinklepsch</a>, May
          2021
        </div>
        <div class="my3 max-width-2 mx-auto">
          <textarea
            id="feedback-input"
            placeholder="Thoughts or feedback? This is the box for it. Also happy to hear how you've been but maybe leave your name in that case :)"
            style="
              width: 80%;
              font-family: sans-serif;
              color: var(--text);
              background-color: var(--bg);
              padding: 8px;
              border-radius: 3px;
              border: 1px solid var(--link);
            "
          ></textarea>
          <script src="https://comments-321314.web.app/cmts.js"></script>
          <script>
            setupInput(document.getElementById("feedback-input"));
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
